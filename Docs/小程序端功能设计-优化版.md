# 小程序端功能设计文档

**文档版本**: v1.0 | **创建时间**: 2025-11-11 | **适用范围**: 小程序端所有功能模块

---

## 1. UI框架架构设计

### 1.1 开发优先级说明

**开发策略调整**: 在开始具体功能模块开发之前，必须优先完成小程序端UI框架架构设计。小程序端作为用户直接交互的移动端应用，清晰的页面结构和导航逻辑是所有功能模块的基础框架。

**重要性说明**:
- 确保小程序端用户体验的一致性和流畅性
- 为用户提供清晰的导航路径和功能发现
- 避免功能模块开发时出现页面布局混乱或遗漏
- 为不同用户状态提供个性化的界面展示

### 1.2 导航架构设计

**小程序端采用底部Tab + 页面内导航结构**:

#### 底部Tab导航 (4个主要Tab)
```
┌─────────────────────────────────┐
│  🏠 首页    │  ⛺ 营地     │  💬 社区     │  👤 我的     │
└─────────────────────────────────┘
```

#### 各Tab内功能结构
```
🏠 首页
├── 搜索框 (搜索您想去的地方)
├── 轮播Banner
├── 功能入口 (四个圆形图标)
│   ├── 🚗 房车租赁
│   ├── ⛺ 营地预订
│   ├── 🚌 旅游大巴
│   └── 🧳 套餐
├── 房车预定组件 (首页内表单)
│   ├── 城市选择器
│   ├── 门店选择器
│   ├── 异地还车选项
│   ├── 租期选择器
│   └── 查询按钮 (点击跳转房车列表)
├── 推荐房车 (横向滚动卡片)
├── 附近门店
└── 热门活动

🏠 首页 - 房车列表页 (房车预定组件查询后跳转)
├── 房车列表展示
│   ├── 房车卡片 (图片、价格、评分、标签)
│   ├── 筛选条件 (继承首页查询条件，可调整)
│   ├── 排序选项 (综合排序、价格、距离)
│   └── 分页加载
└── 房车详情页
    ├── 车辆图片轮播
    ├── 基本信息 (型号、座位、配置)
    ├── 价格信息 (基于租期计算)
    ├── 评价信息
    └── 预订按钮

⛺ 营地
├── 筛选条件 (类型、价格、位置)
├── 排序选项 (推荐、价格、距离、评分)
├── 营地列表
└── 营地详情

💬 社区
├── 话题分类
├─�� 热门帖子
├── 我的关注
├── 发布帖子
└── 帖子详情

👤 我的
├── 用户信息
├── 我的订单
├── 我的收藏
├── 我的推广
├── 钱包余额
├── PLUS会员
└── 设置帮助
```

### 1.3 页面跳转逻辑

**核心跳转路径**:
```
首页 → 房车预定组件 (选择城市、门店、异地还车、租期) → 点击查询 → 房车列表页 → 选择房车 → 房车详情页 → 预订下单 → 支付成功 → 订单管理
首页 → 营地预订图标 → 营地列表页 → 选择营地 → 营地详情页 → 预订下单 → 支付成功 → 订单管理
我的 → 我的订单 → 订单详情 → 车辆使用 → 评价
社区 → 帖子详情 → 点赞评论 → 用户主页
```

### 1.4 用户状态差异化设计

**未登录用户界面**:
- 展示有限的浏览功能
- 引导用户登录/注册
- 显示登录提示和激励信息

**已登录用户界面**:
- 展示完整的功能模块
- 个性化推荐和内容
- 显示会员状态和权益

**PLUS会员界面**:
- 额外特权标识和入口
- 专属优惠和服务
- VIP客服入口

---

## 2. 小程序端概述

### 2.1 功能描述

叨叨房车小程序是面向C端用户的移动端应用，为用户提供房车租赁、营地预订、定制旅游、社区互动、众筹投资等一站式房车旅行服务。支持用户注册、预订、支付、评价等全流程服务。

### 2.2 业务价值

- **便捷预订**: 随时随地查看房车信息，快速完成预订
- **透明价格**: 明码标价，费用清晰透明
- **安全保障**: 多重认证，保险完备，用车无忧
- **社区互动**: 房车爱好者交流分享，增强用户粘性
- **创新模式**: 众筹模式，让众筹车主共享房车租赁收益

### 2.3 用户角色

- **普通用户**: 基础租车用户，享受标准服务
- **PLUS会员**: 付费会员，享受专属优惠和特权
- **众筹车主**: 参与众筹的车主，享受收益分润
- **推广用户**: 参与推广的用户，获得推广收益

### 2.4 验收标准

- 支持完整的用户注册登录流程
- 实现流畅的房车预订和支付体验
- 提供清晰的订单跟踪和管理功能
- 支持社区互动和内容分享
- 系统响应时间 < 2秒，并发支持1000用户

---

## 3. 核心业务功能

### 3.1 首页模块

#### 功能描述
提供小程序首页展示，包含搜索、推荐、快捷入口、热门内容等功能，作为用户进入小程序的主要入口。

#### 核心功能列表
| 功能类别 | 功能名称 | 功能描述 | 优先级 |
|---------|---------|---------|--------|
| 搜索功能 | 智能搜索 | 房车、营地、地点智能搜索 | P0 |
| 轮播展示 | Banner轮播 | 活动Banner、促销信息展示 | P1 |
| 快捷入口 | 功能快捷 | 常用功能快速入口 | P1 |
| 推荐内容 | 个性化推荐 | 基于用户偏好的内容推荐 | P1 |
| 热门展示 | 热门排行 | 热门房车、营地、话题展示 | P2 |

#### 主要业务流程
- 首页加载流程：启动页 → 定位权限 → 首页内容加载 → 个性化推荐
- 搜索流程：输入搜索词 → 搜索建议 → 搜索结果 → 结果筛选
- 推荐展示流程：用户行为分析 → 推荐算法 → 内容展示 → 点击反馈

#### 数据需求
- **user_profiles** (用户画像表) - 数据字典: 01-用户相关表.md
- **recommendation_logs** (推荐日志表) - 需要创建
- **search_logs** (搜索日志表) - 需要创建

### 3.2 房车模块

#### 功能描述
提供房车浏览、搜索、筛选、预订等核心功能，是小程序的主要业务模块。

#### 核心功能列表
| 功能类别 | 功能名称 | 功能描述 | 优先级 |
|---------|---------|---------|--------|
| 房车浏览 | 房车列表 | 房车信息展示、图片、价格 | P0 |
| 搜索筛选 | 多维筛选 | 类型、价格、时间、地点筛选 | P0 |
| 房车详情 | 详细信息 | 房车参数、配置、评价、预约 | P0 |
| 预订功能 | 预订下单 | 选择日期、确认信息、支付 | P0 |
| 收藏管理 | 收藏列表 | 收藏喜欢的房车、管理收藏 | P1 |

#### 主要业务流程
- 房车浏览流程：首页房车预定组件 → 选择条件 → 查询房车列表 → 列表浏览 → 详情查看
- 预订流程：选择房车 → 选择日期 → 确认信息 → 支付定金 → 预订成功
- 收藏流程：浏览房车 → 点击收藏 → 加入收藏夹 → 收藏管理

#### 数据需求
- **vehicles** (车辆表) - 数据字典: 03-车辆相关表.md
- **vehicle_images** (车辆图片表) - 数据字典: 03-车辆相关表.md
- **vehicle_reviews** (车辆评价表) - 数据字典: 03-车辆相关表.md

### 3.3 营地模块

#### 功能描述
提供营地浏览、搜索、预订、评价等功能，为房车用户提供配套住宿服务。

#### 核心功能列表
| 功能类别 | 功能名称 | 功能描述 | 优先级 |
|---------|---------|---------|--------|
| 营地浏览 | 营地列表 | 营地信息、设施、价格展示 | P1 |
| 搜索筛选 | 条件筛选 | 位置、价格、设施筛选 | P1 |
| 营地详情 | 详细信息 | 营地介绍、设施图片、评价 | P1 |
| 预订功能 | 营地预订 | 选择日期、预订数量、支付 | P1 |
| 评价管理 | 评价系统 | 营地评价、评分、图片上传 | P2 |

#### 主要业务流程
- 营地浏览流程：附近营地 → 筛选条件 → 列表浏览 → 详情查看
- 预订流程：选择营地 → 选择日期 → 预订数量 → 支付确认 → 预订成功

#### 数据需求
- **campsites** (营地表) - 需要创建
- **campsite_images** (营地图片表) - 需要创建
- **campsite_reviews** (营地评价表) - 需要创建

### 3.4 订单模块

#### 功能描述
管理用户订单，包括订单创建、支付、跟踪、取消、评价等全流程管理。

#### 核心功能列表
| 功能类别 | 功能名称 | 功能描述 | 优先级 |
|---------|---------|---------|--------|
| 订单创建 | 下单流程 | 选择产品、确认信息、生成订单 | P0 |
| 支付功能 | 订单支付 | 多种支付方式、安全支付 | P0 |
| 订单跟踪 | 状态跟踪 | 订单状态实时跟踪和提醒 | P0 |
| 订单管理 | 订单操作 | 订单查看、取消、修改 | P1 |
| 评价系统 | 服务评价 | 订单完成后评价和反馈 | P1 |

#### 主要业务流程
- 下单流程：选择产品 → 确认信息 → 生成订单 → 支付 → 订单确认
- 跟踪流程：状态更新 → 消息推送 → 用户查看 → 确认收货
- 评价流程：订单完成 → 评价邀请 → 用户评价 → 评价展示

#### 数据需求
- **orders** (订单表) - 数据字典: 04-订单业务表.md
- **order_items** (订单明细表) - 数据字典: 04-订单业务表.md
- **order_payments** (支付记录表) - 数据字典: 04-订单业务表.md

---

## 4. 社区与推广功能

### 4.1 社区模块

#### 功能描述
提供房车爱好者社区交流平台，包含话题讨论、内容分享、用户互动等功能。

#### 核心功能列表
| 功能类别 | 功能名称 | 功能描述 | 优先级 |
|---------|---------|---------|--------|
| 内容浏览 | 帖子列表 | 话题帖子、热门内容展示 | P2 |
| 内容发布 | 发帖功能 | 文字、图片、视频发布 | P2 |
| 互动功能 | 点赞评论 | 点赞、评论、分享互动 | P2 |
| 用户关注 | 关注系统 | 关注用户、话题管理 | P2 |
| 内容管理 | 内容审核 | 内容举报、违规处理 | P2 |

#### 主要业务流程
- 浏览流程：打开社区 → 浏览内容 → 查看详情 → 互动操作
- 发布流程：选择话题 → 编辑内容 → 发布成功 → 用户互动
- 互动流程：查看帖子 → 点赞评论 → 分享传播

#### 数据需求
- **community_posts** (社区帖子表) - 数据字典: 07-内容管理表.md
- **post_comments** (评论表) - 数据字典: 07-内容管理表.md
- **user_follows** (关注表) - 需要创建

### 4.2 推广模块

#### 功能描述
提供用户推广功能，邀请好友获得奖励，帮助平台用户增长。

#### 核心功能列表
| 功能类别 | 功能名称 | 功能描述 | 优先级 |
|---------|---------|---------|--------|
| 推广邀请 | 邀请好友 | 生成邀请链接、分享邀请 | P2 |
| 推广奖励 | 奖励机制 | 注册奖励、消费返佣 | P2 |
| 推广数据 | 数据统计 | 推广效果、收益统计 | P2 |
| 推广工具 | 推广素材 | 海报、文案、链接生成 | P2 |

#### 主要业务流程
- 邀请流程：生成邀请链接 → 分享好友 → 好友注册 → 获得奖励
- 收益流程：推广数据统计 → 收益计算 → 收益发放 → 提现管理

#### 数据需求
- **promotion_records** (推广记录表) - 数据字典: 06-营销活动表.md
- **promotion_rewards** (推广奖励表) - 需要创建

---

## 5. 用户中心功能

### 5.1 用户中心模块

#### 功能描述
提供个人信息管理、订单管理、收藏管理、设置帮助等用户服务功能。

#### 核心功能列表
| 功能类别 | 功能名称 | 功能描述 | 优先级 |
|---------|---------|---------|--------|
| 个人信息 | 用户资料 | 头像、昵称、基本信息管理 | P1 |
| 订单管理 | 我的订单 | 订单列表、详情、状态跟踪 | P1 |
| 收藏管理 | 我的收藏 | 收藏房车、营地、帖子管理 | P1 |
| 设置帮助 | 系统设置 | 账号设置、帮助中心、关于 | P2 |
| 消息中心 | 消息管理 | 系统消息、订单提醒、活动通知 | P2 |

#### 主要业务流程
- 资料管理：进入个人中心 → 编辑资料 → 保存修改 → 更新成功
- 订单管理：查看订单列表 → 选择订单 → 查看详情 → 相关操作

#### 数据需求
- **users** (用户表) - 数据字典: 01-用户相关表.md
- **user_favorites** (收藏表) - 需要创建
- **system_messages** (系统消息表) - 需要创建

### 5.2 钱包模块

#### 功能描述
提供钱包余额、充值、提现、收益管理等财务相关功能。

#### 核心功能列表
| 功能类别 | 功能名称 | 功能描述 | 优先级 |
|---------|---------|---------|--------|
| 余额管理 | 钱包余额 | 余额查询、交易明细 | P2 |
| 充值功能 | 充值服务 | 多种充值方式、充值记录 | P2 |
| 收益管理 | 收益统计 | 推广收益、众筹收益统计 | P2 |
| 提现功能 | 提现服务 | 提现申请、提现记录 | P2 |

#### 主要业务流程
- 充值流程：选择充值金额 → 选择支付方式 → 完成支付 → 余额到账
- 提现流程：申请提现 → 审核处理 → 提现成功 → 资金到账

#### 数据需求
- **wallets** (钱包表) - 需要创建
- **wallet_transactions** (钱包交易表) - 需要创建
- **withdrawal_requests** (提现申请表) - 需要创建

### 5.3 会员模块

#### 功能描述
提供PLUS会员服务，包括会员特权、会员购买、会员权益等功能。

#### 核心功能列表
| 功能类别 | 功能名称 | 功能描述 | 优先级 |
|---------|---------|---------|--------|
| 会员特权 | 权益展示 | 会员特权、优惠信息展示 | P2 |
| 会员购买 | 订阅服务 | 会员套餐选择、支付购买 | P2 |
| 会员管理 | 会员状态 | 会员状态、有效期管理 | P2 |
| 会员服务 | 专属服务 | 专属客服、专属优惠 | P2 |

#### 主要业务流程
- 购买流程：查看特权 → 选择套餐 → 支付购买 → 会员激活
- 服务使用：会员验证 → 权益享受 → 服务���录

#### 数据需求
- **membership_plans** (会员套餐表) - 需要创建
- **user_memberships** (用户会员表) - 需要创建
- **membership_benefits** (会员权益表) - 需要创建

---

## 6. 特殊业务功能

### 6.1 众筹模块

#### 功能描述
提供房车众筹项目浏览、投资、收益管理等功能，让用户参与房车众筹。

#### 核心功能列表
| 功能类别 | 功能名称 | 功能描述 | 优先级 |
|---------|---------|---------|--------|
| 项目浏览 | 众筹项目 | 项目列表、详情、进度展示 | P2 |
| 投资功能 | 份额购买 | 选择项目、购买份额、支付 | P2 |
| 收益管理 | 收益统计 | 收益查询、收益明细 | P2 |
| 份额管理 | 份额交易 | 份额查看、转让、赎回 | P2 |

#### 主要业务流程
- 投资流程：查看项目 → 选择份额 → 支付购买 → 成为股东
- 收益流程：收益计算 → 收益分配 → 资金到账 → 收益记录

#### 数据需求
- **crowdfunding_projects** (众筹项目表) - 数据字典: 05-众筹管理表.md
- **crowdfunding_shares** (众筹份额表) - 数据字典: 05-众筹管理表.md
- **share_transactions** (份额交易表) - 需要创建

### 6.2 特惠租车模块

#### 功能描述
提供固定路线特价租车服务，降低用户出行成本。

#### 核心功能列表
| 功能类别 | 功能名称 | 功能描述 | 优先级 |
|---------|---------|---------|--------|
| 特惠浏览 | 特惠列表 | 特惠套餐、价格展示 | P2 |
| 预订功能 | 特惠预订 | 套餐选择、预订支付 | P2 |
| 路线管理 | 路线信息 | 路线详情、站点信息 | P2 |

#### 数据需求
- **special_offers** (特惠套餐表) - 需要创建
- **special_routes** (特惠路线表) - 需要创建

### 6.3 定制旅游模块

#### 功能描述
提供个性化路线定制旅游服务，专业导游服务。

#### 核心功能列表
| 功能类别 | 功能名称 | 功能描述 | 优先级 |
|---------|---------|---------|--------|
| 定制需求 | 需求提交 | 旅行需求描述、预算提交 | P2 |
| 方案报价 | 方案设计 | 定制方案、价格报价 | P2 |
| 服务管理 | 旅游服务 | 导游安排、行程管理 | P2 |

#### 数据需求
- **custom_tours** (定制旅游表) - 需要创建
- **tour_quotes** (旅游报价表) - 需要创建

---

## 7. 集成需求

### 7.1 内部模块依赖

- **用户中心模块**: 被所有业务模块依赖，提供用户信息和权限
- **订单模块**: 依赖房车、营地、众筹模块，生成订单数据
- **支付模块**: 被订单、会员、众筹模块依赖，处理支付流程
- **消息模块**: 被所有模块依赖，提供消息通知服务

### 7.2 外部接口需求

**支付服务接口**:
- 微信支付: POST /api/payments/wechat
- 支付宝: POST /api/payments/alipay
- 余额支付: POST /api/payments/wallet

**地图服务接口**:
- 地图定位: GET /api/location/current
- 地址解析: GET /api/location/geocode
- 距离计算: GET /api/location/distance

**短信服务接口**:
- 验证码发送: POST /api/sms/send
- 验证码验证: POST /api/sms/verify

### 7.3 管理端数据同步

- **用户信息同步**: 用户注册信息同步到管理端审核
- **订单状态同步**: 订单状态实时同步到管理端
- **支付信息同步**: 支付记录实时同步到财务系统
- **评价信息同步**: 用户评价同步到管理端

---

## 8. 验收场景

### 8.1 正常场景

**用户操作场景**:
- 用户注册登录流程正常，支持多种登录方式
- 房车浏览筛选流畅，信息展示完整准确
- 预订下单流程顺畅，支付成功及时确认
- 订单跟踪及时准确，状态更新实时推送

**业务流程场景**:
- 推广邀请流程正常，奖励发放及时准确
- 众筹投资流程顺畅，权益分配公平透明
- 会员服务正常，特权享受无障碍
- 社区互动活跃，内容展示正常

### 8.2 异常场景

**异常处理场景**:
- 网络异常时数据缓存，断线后数据不丢失
- 支付异常时及时回滚，订单状态准确
- 系统异常时自动恢复，用户操作可继续
- 数据异常时及时提示，用户信息保护

### 8.3 性能要求

**响应时间要求**:
- 页面加载时间 < 2秒
- API接口响应时间 < 1秒
- 搜索响应时间 < 2秒
- 支付处理时间 < 10秒

**并发性能要求**:
- 支持1000个用户同时在线
- 支持500个并发API请求
- 支持10000个订单/天处理量

**用户体验要求**:
- 页面交互流畅，无明显卡顿
- 图片加载优化，显示清晰
- 操作反馈及时，状态明确
- 错误提示友好，解决指引清晰

---

## 9. 模块开发优先级

### Phase 0: UI框架架构 (P0 - 基础框架)
1. **UI框架架构设计** - Tab导航、页面布局、状态管理

### Phase 1: 核心业务模块 (P0)
2. **首页模块** - 主要入口，用户体验基础，包含房车功能入口
3. **用户中心模块** - 用户服务核心
4. **订单模块** - 核心流程，交易闭环
5. **支付模块** - 交易必需，资金安全

### Phase 2: 支撑业务模块 (P0-P1)
6. **营地模块** - 配套服务，业务延伸
7. **消息模块** - 用户体验，及时通知

### Phase 3: 增值业务模块 (P1-P2)
8. **社区模块** - 用户粘性，平台生态
9. **推广模块** - 用户增长，商业价值
10. **钱包模块** - 财务管理，资金安全
11. **会员模块** - 商业模式，增值服务

### Phase 4: 创新业务模块 (P2)
12. **众筹模块** - 创新模式，差异化竞争
13. **特惠租车模块** - 价格策略，市场拓展
14. **定制旅游模块** - 高端服务，用户细分

---